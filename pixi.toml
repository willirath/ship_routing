[workspace]
name = "ship-routing"
version = "2024.04.10.1"
description = "Ship Route Optimisation"
authors = ["Willi Rath <wrath@geomar.de>"]
channels = ["conda-forge"]
platforms = ["linux-64", "osx-64", "osx-arm64"]

[dependencies]
python = "3.11.*"
black = "24.*"
bokeh = "*"
cartopy = "*"
dask = "*"
distributed = "*"
jupyterlab = "*"
matplotlib = "*"
netcdf4 = "*"
numpy = "*"
pandas = "*"
pint = "*"
pyproj = "*"
pytest = "*"
"pytest-datafiles" = "*"
pytest-cov = "*"
scipy = "*"
shapely = "*"
tqdm = "*"
xarray = "*"
zarr = "*"
ipdb = ">=0.13.13,<0.14"
black-jupyter = ">=24.10.0,<25"
ipywidgets = ">=8.1.8,<9"
seaborn = ">=0.13.2,<0.14"
line_profiler = ">=5.0.0,<6"
zstd = ">=1.5.7,<2"
tar = ">=1.35,<2"
redis-server = "*"
redis-py = "*"
msgpack-python = "*"
shellcheck = ">=0.10.0,<0.11"
rsync = ">=3.4.1,<4"
geopandas = ">=1.1.1,<2"
cmocean = ">=4.0.3,<5"
tabulate = ">=0.9.0,<0.10"
copernicusmarine = ">=2.2.5,<3"
click = ">=8.0,<9"

[tasks]
tests = "pytest -q"
lint = "black --check src tests"
format = "black src tests"
jupyterlab = "jupyter lab"
coverage = "coverage erase && coverage run --source=src/ship_routing -m pytest && coverage report --show-missing"
download-data = { cmd = "bash scripts/download_data.sh", description = "Download large data files from Git LFS repository" }
check-data = { cmd = """
    python -c '
from pathlib import Path
import sys
PROJECT_ROOT = Path.cwd()
TEST_DATA_DIR = PROJECT_ROOT / "data" / "test"
LARGE_DATA_DIR = PROJECT_ROOT / "data" / "large"
test_ok = TEST_DATA_DIR.exists() and any(TEST_DATA_DIR.glob("*/*.nc"))
large_ok = LARGE_DATA_DIR.exists() and any(LARGE_DATA_DIR.glob("*.zarr"))
print("Test data: " + ("OK" if test_ok else "MISSING"))
print("Large data: " + ("OK" if large_ok else "MISSING (run pixi run download-data)"))
sys.exit(0 if test_ok else 1)
'
""", description = "Check if data directories are properly set up" }

[pypi-dependencies]
"ship_routing" = { path = ".", editable = true }
